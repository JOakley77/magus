/*!
Package: magus (www.jasonthedev.com/plugins/magus)
Version: 1.0.0
Last updated: 2013-07-30
* Author: Jason Oakley <magus@jasonthedev.com>;
* Website: www.jasonthedev.com */
!function(a,b,c,d){var e="awizard",f=function(c,d){var e={debug:!1,active_panel:0,disable_panels:!0,height:null,panel_height:null,active_can_close:!1,set_active_completed_on_show:!0,collapse_active_on_show:!0,disable_bs_transition:!0,acc_group_class:".accordion-group",acc_heading_class:".accordion-heading",acc_toggle_class:".accordion-toggle",acc_collapsible_class:".collapse",disabled_class:".acc-disabled",active_class:".acc-active",inactive_class:".acc-inactive",completed_class:".acc-completed",button_class:".btn",show_sidebar:!0,sidebar_node_elem:"li",sidebar_class:".awizard-sidebar",init:function(){},beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},onDisable:function(){},onEnable:function(){},onComplete:function(){}};return this.options=a.extend(!0,e,d),this.self=a(c),this.sidebar=a(this.sidebar_class),this._init(c,d),b.awizard=this,this};f.prototype._init=function(){this._setup(),null!==this.options.height&&this.setAccordionHeight(this.options.height),this._hook("init",this),this._listen()},f.prototype._cleanSelector=function(a){return a.replace(".","")},f.prototype._hook=function(a){if(this.options[a]!==d){var b=this.options[a];return arguments[0]=this.self,b.apply(this,arguments)}},f.prototype._setup=function(){var b=this;b.self.data("defaultPanel")!==d&&(b.options.active_panel=b.self.data("defaultPanel")),b.self.nodes=[],a.each(b.self.find(this.options.acc_group_class),function(c,e){var f=a(e);b.self.nodes.push({index:c,target:f.find(b.options.acc_toggle_class).attr("href"),elem:f,collapsible:f.find(b.options.acc_collapsible_class),active:!1,disabled:f.data("disabled"),completed:!1}),b.self.nodes[b.options.active_panel]!==d&&(b.self.nodes[b.options.active_panel].active=!0),b.self.data("disablePanels")!==d&&b.self.data("disablePanels")===!0&&b.self.nodes[c].active!==!0&&(b.self.nodes[c].disabled=!0),b.self.nodes[c].active!==d&&b.self.nodes[c].active===!0&&b.self.nodes[c].elem.addClass(b._cleanSelector(b.options.active_class)).find(b.options.acc_collapsible_class).addClass("in"),b.self.nodes[c].disabled!==d&&b.self.nodes[c].disabled===!0&&(b.self.nodes[c].elem.addClass(b._cleanSelector(b.options.disabled_class)),b.self.nodes[c].elem.find(b._cleanSelector(b.options.acc_toggle_class)).removeAttr("data-toggle"))}),this.options.show_sidebar===!0&&(b.sidebar=a(this.options.sidebar_class),a.each(b.sidebar.find(b.options.sidebar_node_elem),function(c,d){var e=a(d),f=a.grep(b.self.nodes,function(a){return a.target===e.find("a").attr("href")});b.self.nodes[f[0].index].sb_elem=e,b.self.nodes[f[0].index].active===!0&&e.addClass(b._cleanSelector(b.options.active_class)),b.self.nodes[f[0].index].disabled===!0&&e.addClass(b._cleanSelector(b.options.disabled_class)),b.self.nodes[f[0].index].completed===!0&&e.addClass(b._cleanSelector(b.options.completed_class))})),null!==b.options.panel_height&&b.setPanelHeight(b.options.active_panel,b.options.panel_height)},f.prototype._listen=function(){var e=this;a(c).on("click",e.options.button_class,function(b){var c=a(b.currentTarget);b.preventDefault(),b.stopPropagation(),e.options.disable_bs_transition===!0&&(a.fn.collapse.Constructor.prototype.transition=function(){return!1}),c.data("disable")!==d&&c.data("disable")===!0?e.disable(c.data("panel"),!0):c.data("disable")!==d&&c.data("disable")===!1?e.disable(c.data("panel"),!1):e.goTo(c.data("panel"),c.data("completed"))}),a(this.options.acc_toggle_class).on("click",function(c){var d=b.awizard,e=a(c.currentTarget),f=e.closest(d.options.acc_group_class),g=a.grep(d.self.nodes,function(a){return a.target===e.attr("href")});return c.preventDefault(),c.stopPropagation(),f.hasClass(d.options.disabled_class.replace(".",""))||d.options.active_can_close===!1?!1:(d.show(g[0].index),!1)}),a(this.options.sidebar_class+" "+this.options.sidebar_node_elem+" a").on("click",function(c){var d=b.awizard,e=a(c.currentTarget),f=(e.closest(d.options.acc_group_class),a.grep(d.self.nodes,function(a){return a.target===e.attr("href")}));return c.preventDefault(),c.stopPropagation(),f[0].disabled===!0||d.options.active_can_close===!1?!1:(d.show(f[0].index),void 0)})},f.prototype.setAccordionHeight=function(a){return this.self.height(parseInt(a,10)),this.self},f.prototype.getActivePanel=function(){return a.grep(this.self.nodes,function(a){return a.active})[0]},f.prototype.setPanelHeight=function(a,b){var c=this.self.nodes[a];return c.collapsible.height(parseInt(b)),this.self},f.prototype.show=function(b){var c=this,e=a.grep(this.self.nodes,function(a){return a.active}),f=this.self.nodes[b];return f!==d&&e[0].index!==b&&(c.options.collapse_active_on_show===!0&&c.hide(e[0].index),c._hook("beforeShow",e[0],f),f.active=!0,f.elem.removeClass(c._cleanSelector(c.options.inactive_class)).addClass(c._cleanSelector(c.options.active_class)),f.collapsible.collapse("show"),f.sb_elem.removeClass(c._cleanSelector(c.options.inactive_class)).addClass(c._cleanSelector(c.options.active_class)),null!==this.options.panel_height&&this.setPanelHeight(f.index,this.options.panel_height),c._hook("afterShow",c,e[0],f)),this.self},f.prototype.hide=function(a){var b=this,c=this.self.nodes[a];return c!==d&&(b._hook("beforeHide"),c.active=!1,c.elem.addClass(b._cleanSelector(this.options.inactive_class)).removeClass(b._cleanSelector(this.options.active_class)),c.collapsible.collapse("hide"),c.sb_elem.addClass(b._cleanSelector(b.options.inactive_class)).removeClass(b._cleanSelector(b.options.active_class)),null!==this.options.panel_height&&this.setPanelHeight(c.index,0),b._hook("afterHide")),this.self},f.prototype.goTo=function(b,c){var e=this,f=a.grep(this.self.nodes,function(a){return a.active}),g=this.self.nodes[b],h=!0;return g!==d&&(e.disable(b,!1),c!==d&&c===!1&&(h=!1),e.complete(f[0].index,h),e.show(g.index)),this.self},f.prototype.disable=function(a,b){var c=this,e=this.self.nodes[a];return e!==d&&(b!==d&&b===!0&&(e.disabled=!0,e.elem.addClass(c._cleanSelector(c.options.disabled_class)),e.sb_elem.addClass(c._cleanSelector(c.options.disabled_class)),c._hook("onDisable")),b!==d&&b===!1&&(e.disabled=!1,e.elem.removeClass(c._cleanSelector(c.options.disabled_class)),e.sb_elem.removeClass(c._cleanSelector(c.options.disabled_class)),c._hook("onEnable"))),this.self},f.prototype.complete=function(a,b){var c=this,e=this.self.nodes[a];return e!==d&&(b!==d&&b===!0&&(e.completed=!0,e.elem.addClass(c._cleanSelector(c.options.completed_class)),e.sb_elem.addClass(c._cleanSelector(c.options.completed_class))),b!==d&&b===!1&&(e.completed=!1,e.elem.removeClass(c._cleanSelector(c.options.completed_class)),e.sb_elem.removeClass(c._cleanSelector(c.options.completed_class))),c._hook("onComplete")),this.self},a.fn[e]=function(b){if(!a(this).length)return a(this);var c=a(this).data(e);return c&&0!=b.indexOf("_")&&c[b]&&"function"==typeof c[b]?c[b](Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(c?0==b.indexOf("_")?a.error("Method "+b+" is private!"):a.error("Method "+b+" does not exist."):a.error("Plugin must be initialised before using method: "+b),void 0):(c=new f(a(this),b),a(this).data(e,c),a(this))}}(jQuery,window,document);