/*!
Package: magus (www.jasonthedev.com/plugins/magus)
Version: 1.0.0
Last updated: 2013-08-03
* Author: Jason Oakley <magus@jasonthedev.com>;
* Website: www.jasonthedev.com */
+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.proxy=a.proxy(this.$element,this);var e={};e.this=this,e.el=this.$element,this._isDefined(this.$element.data("defaultPanel"))&&(this.options.active=this.$element.data("defaultPanel")),this._isDefined(this.$element.data("disablePanels"))&&(this.options.disable_nonactive=this.$element.data("disablePanels"));var f=this.options.manage_steps?this.$element.find(this.options.sel_steps):null;this.last=this.options.active,this.$element.panels=[],a.each(this.$element.find(this.options.bs_sel_group),function(b,c){var d=a(c);e.el.panels.push({index:b,acc_panel:d,acc_body:d.find(e.this.options.bs_sel_body),target:d.find(e.this.options.bs_sel_toggle).attr("href"),step:void 0!==f?f.find(e.this.options.steps_node_element).eq(b):null,active:b===e.this.options.active?!0:!1,disabled:b===e.this.options.active?!1:e.this.options.disable_nonactive,completed:!1}),e.el.panels[b].active===!0&&(e.this.active=e.el.panels[b],e.this.show(b)),e.el.panels[b].disabled===!0&&e.this.disabled(b,!0)}),this.options.disable_toggle&&(a(document).off("click.bs.collapse.data-api"),a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(a){return a.isDefaultPrevented=!0,a.preventDefault(),a.stopPropagation(),!1}))};b.DEFAULTS={debug:!1,active:0,disable_nonactive:!0,disable_toggle:!0,collapse_active_on_show:!0,show_icons:!0,magus:".magus",sel_disabled:".magus-disabled",icon_disabled:'<span class="glyphicon glyphicon-ban-circle"></span>',enable_disabled_icon:!0,sel_active:".magus-active",icon_active:'<span class="glyphicon glyphicon-pushpin"></span>',enable_active_icon:!0,sel_inactive:".magus-inactive",icon_inactive:'<span class="glyphicon glyphicon-ok"></span>',enable_inactive_icon:!0,sel_completed:".magus-completed",icon_completed:'<span class="glyphicon glyphicon-ok-circle"></span>',enable_completed_icon:!0,sel_alert:".magus-alert",icon_alert:'<span class="glyphicon glyphicon-warning-sign"></span>',enable_alert_icon:!0,manage_steps:!0,sel_steps:".magus-steps",steps_node_element:"li",bs_sel_group:".accordion-group",bs_sel_heading:".accordion-heading",bs_sel_toggle:".accordion-toggle",bs_sel_body:".collapse",trigger_goto:"[data-goto]",trigger_prev:'[data-goto="prev"]',trigger_next:'[data-goto="next"]',trigger_hide:"[data-hide]",trigger_show:"[data-show]",trigger_alert:"[data-alert]",trigger_disable:"[data-disable]"},b.prototype._isDefined=function(a){return void 0!==a?!0:!1},b.prototype._cleanSelector=function(a){return a.replace(".","")},b.prototype._setIcon=function(a,b){var c,d=this.$element.panels[parseInt(a,10)];if(this.options.show_icons){switch(b){case"disabled":c=this.options.enable_disabled_icon===!0?this.options.icon_disabled:null;break;case"active":c=this.options.enable_active_icon===!0?this.options.icon_active:null;break;case"inactive":c=this.options.enable_inactive_icon===!0?this.options.icon_inactive:null;break;case"completed":c=this.options.enable_completed_icon===!0?this.options.icon_completed:null;break;case"alert":c=this.options.enable_alert_icon===!0?this.options.icon_alert:null}if(c){var e=d.acc_panel.find(this.options.bs_sel_toggle);e.html(c+e.html().replace(/<\/?[^>]+(>|$)/g,""))}}},b.prototype.getActivePanel=function(){return a.grep(this.$element.panels,function(a){return a.active})[0]},b.prototype.setAlert=function(a){var b=$scope.element.nodes[parseInt(a,10)];return void 0!==b&&(b.element.addClass($scope.plugin._cleanSelector($scope.options.alert_class)),b.step.addClass($scope.plugin._cleanSelector($scope.options.alert_class)),scope.plugin._setIcon(parseInt(a,10),"alert")),$scope.plugin},b.prototype.setComplete=function(a,b){var c=this.$element.panels[parseInt(a,10)];return void 0!==b&&b===!0&&(c.completed=!0,c.acc_panel.addClass(this._cleanSelector(this.options.sel_completed)),c.step.addClass(this._cleanSelector(this.options.sel_completed))),void 0!==b&&b===!1&&(c.completed=!1,c.acc_panel.removeClass(this._cleanSelector(this.options.sel_completed)),c.step.removeClass(this._cleanSelector(this.options.sel_completed))),this},b.prototype.show=function(a){var b=this.$element.panels[parseInt(a,10)];return b.active=!0,b.acc_panel.removeClass(this._cleanSelector(this.options.sel_inactive)).addClass(this._cleanSelector(this.options.sel_active)),this._setIcon(parseInt(a,10),"active"),b.step.removeClass(this._cleanSelector(this.options.sel_inactive)).addClass(this._cleanSelector(this.options.sel_active)),this.active=b,b.acc_body.collapse("show"),this},b.prototype.hide=function(a){var b=this.$element.panels[parseInt(a,10)];return b.active=!1,b.acc_panel.addClass(this._cleanSelector(this.options.sel_inactive)).removeClass(this._cleanSelector(this.options.sel_active)).removeClass(this._cleanSelector(this.options.sel_alert)),this._setIcon(parseInt(a,10),"inactive"),b.acc_body.collapse("hide"),b.step.addClass(this._cleanSelector(this.options.sel_inactive)).removeClass(this._cleanSelector(this.options.sel_active)).removeClass(this._cleanSelector(this.options.sel_alert)),this},b.prototype.disabled=function(a,b){var c=this.$element.panels[parseInt(a,10)];return void 0!==b&&b===!0&&(c.disabled=!0,c.acc_panel.addClass(this._cleanSelector(this.options.sel_disabled)),c.step.addClass(this._cleanSelector(this.options.sel_disabled)),this._setIcon(parseInt(a,10),"disabled")),void 0!==b&&b===!1&&(c.disabled=!1,c.acc_panel.removeClass(this._cleanSelector(this.options.sel_disabled)),c.step.removeClass(this._cleanSelector(this.options.sel_disabled))),this},b.prototype.goto=function(a,b){var c=!0,d=this.$element.panels[parseInt(a,10)];return void 0!==d&&(this.disabled(a,!1),void 0!==b&&b===!1&&(c=!1),this.setComplete(this.active.index,c),this.hide(this.active.index),this.show(d.index)),this};var c=a.fn.magus;a.fn.magus=function(c){return this.each(function(){var d=a(this),e=d.data("bs.plugin.magus"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);e||d.data("bs.plugin.magus",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.magus.Constructor=b,a.fn.magus.noConflict=function(){return a.fn.magus=c,this},a(document).on("click.bs.plugin.magus.data-api","[data-goto], .magus-steps a",function(b){var c,d=a(this),e=d.data("goto"),f=d.closest(".magus").data("bs.plugin.magus");if(void 0===e){var g=a.grep(f.$element.panels,function(a){return a.target===d.attr("href")})[0];if("object"==typeof g){if(g.disabled)return!1;c=g.index}}else c="prev"===e?f.active.index-1<0?0:f.active.index-1:"next"===e?f.active.index!==f.$element.panels.length-1?f.active.index+1:f.active.index:parseInt(d.data("goto"),10);return c===f.getActivePanel().index?!1:(f.goto(c),b.preventDefault(),void 0)}),a(window).on("load",function(){a("[data-magus]").each(function(){var b=a(this);b.magus(b.data())})})}(window.jQuery);